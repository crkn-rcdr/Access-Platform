{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "/util/ImageRef",
  "$comment": "Reference to a stored image, which can be found in either the legacy preservation repository or the access platform file store.",
  "title": "Image file reference",
  "type": "object",
  "properties": {
    "path": {
      "type": "string",
      "format": "unixFilePath",
      "nullable": true,
      "description": "Path to the file in the legacy preservation repository.",
      "$comment": "Cannot be defined along with `extension`."
    },
    "extension": {
      "type": "string",
      "enum": [
        "jpg",
        "jp2",
        "jpeg",
        "tif",
        "tiff"
      ],
      "nullable": true,
      "description": "Image file extension.",
      "$comment": "Cannot be defined along with `path`."
    },
    "size": {
      "type": "number",
      "minimum": 0,
      "description": "Size of the file, in bytes."
    },
    "mime": {
      "type": "string",
      "enum": [
        "image/jpeg",
        "image/jp2",
        "image/tiff"
      ],
      "description": "RFC 2046 Media Type (formerly MIME)."
    },
    "height": {
      "type": "integer",
      "minimum": 0,
      "nullable": true,
      "description": "Image height, in pixels.",
      "$comment": "Implies that `width` is defined."
    },
    "width": {
      "type": "integer",
      "minimum": 0,
      "nullable": true,
      "description": "Image width, in pixels.",
      "$comment": "Implies that `height` is defined."
    },
    "update": {
      "title": "Process update",
      "description": "Update for the service that supplies dimension information.",
      "type": "object",
      "properties": {
        "requestDate": {
          "type": "string",
          "format": "timestamp",
          "description": "Most recent request time for the automated process to run."
        },
        "processDate": {
          "type": "string",
          "format": "timestamp",
          "nullable": true,
          "description": "Most recent time the process update took place."
        },
        "succeeded": {
          "type": "boolean",
          "nullable": true,
          "description": "Whether the last process was run successfully on this object."
        },
        "message": {
          "type": "string",
          "nullable": true,
          "description": "Error message supplied by the process."
        }
      },
      "required": [
        "requestDate"
      ],
      "additionalProperties": false,
      "nullable": true
    }
  },
  "required": [
    "mime"
  ],
  "dependencies": {
    "height": [
      "width"
    ],
    "width": [
      "height"
    ]
  },
  "oneOf": [
    {
      "required": [
        "path"
      ]
    },
    {
      "required": [
        "extension"
      ]
    }
  ]
}
