System.register(["./chunk-vendor.js","./chunk-frameworks.js"],(function(e,t){"use strict";var n,o,r,s,c;return{setters:[function(e){n=e.a,o=e.o,r=e.k},function(e){s=e.C,c=e.S}],execute:function(){function e(e){const t=document.createElement("input");return t.setAttribute("type","hidden"),t.setAttribute("name",e.name),t.setAttribute("value",e.value),t}n("change",".js-scanning-alert-check",(function({currentTarget:t}){const n=t.closest(".js-scanning-alert-list"),o=null!=n.querySelector(".js-scanning-alert-check:checked"),r=n.querySelector(".js-scanning-filter-options"),s=n.querySelector(".js-scanning-alert-bulk-actions"),c=n.querySelector(".js-scanning-alert-links");r&&(r.hidden=o),s&&(s.hidden=!o),c&&(c.hidden=o),function(t){let n=!1;const o=t.querySelectorAll(".js-scanning-fixed-alert-numbers"),r=0!==o.length?JSON.parse(o[0].getAttribute("data-numbers")||"[]"):[];for(const s of t.querySelectorAll(".js-scanning-bulk-action-items")){s.innerHTML="";const o=t.querySelectorAll(".js-scanning-alert-list [data-check-all-item]:checked");for(const t of o)n||(n=-1!==r.indexOf(parseInt(t.value))),s.appendChild(e(t))}for(const e of t.querySelectorAll(".js-scanning-reopen-button"))e.hidden=n;for(const e of t.querySelectorAll(".js-scanning-reopen-button-disabled"))e.hidden=!n}(n)})),n("details-menu-selected",".js-scanning-code-path-menu",(function(e){const t=e.detail.relatedTarget.getAttribute("data-target-code-path");for(const n of document.querySelectorAll(".js-scanning-code-path"))n.hidden=t!==n.getAttribute("data-code-path")}),{capture:!0}),o(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0}}),n("click",".js-add-secret-format-button",(e=>{const t=e.currentTarget;if(t&&window.postProcessingExpressionCount<m()){const e=document.querySelectorAll(".js-additional-secret-format");if(!e)return;for(const n of e)if(n.classList.contains("has-removed-contents")){n.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===m()&&(t.hidden=!0);break}}})),n("click",".js-remove-secret-format-button",(e=>{const t=document.querySelector(".js-add-secret-format-button");if(!t)return;const n=e.currentTarget;if(!n)return;const o=n.closest(".js-additional-secret-format");if(!o)return;o.classList.toggle("has-removed-contents",!0);o.getElementsByClassName("js-post-processing-input")[0].value="";const r=o.getElementsByClassName("errored")[0];r&&r.classList.toggle("errored",!1),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<m()&&(t.hidden=!1)})),o(".js-test-code",{async add(){const e=document.querySelector(".js-test-code"),n=e.clientHeight,o=await t.import("./chunk-codemirror.js");if(window.codeEditor=o.default.fromTextArea(e,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:e.value,lineSeparator:"\r\n",theme:"github-light"}),0!==n){const e=document.querySelector(".CodeMirror");e&&(e.style.height=n+"px",e.style.width="640px",e.style.border="1px solid #e1e4e8",e.style.borderRadius="6px")}window.codeEditor.save();const r=document.querySelector(".js-test-custom-secret-scanning-pattern");let s=a;r.hasAttribute("data-source-is-readonly")&&(s=d),window.codeEditor.on("change",(()=>{s(window.codeEditor.getValue())}))}}),s(".js-add-custom-secret-scanning-pattern-form *",(async function(e){window.codeEditor&&a(window.codeEditor.getValue(),e)})),c("keydown",".js-add-custom-secret-scanning-pattern-form *",(function(e){"Enter"===e.key&&e.preventDefault()}));const i=(e,t,n)=>{const o=document.createElement("input");o.type="hidden",o.name=t,o.id=t,o.value=n,e.appendChild(o),o.required=!0},a=r((function(e,t){if(t){const e=t.currentTarget;if(e&&"display_name"===e.id)return}const n=document.querySelector(".js-create-custom-pattern-button");if(!(n instanceof HTMLElement))return;const o=document.querySelector(".js-test-pattern-matches");if(o)if(0===e.length)n.setAttribute("disabled","true"),o.textContent="";else{window.codeEditor.save();const e=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(e instanceof HTMLFormElement))return;const t=document.querySelector(".js-add-custom-secret-scanning-pattern-form");if(!(t instanceof HTMLFormElement))return;for(const n of t.elements)n instanceof HTMLInputElement&&n.name&&("text"===n.type||"radio"===n.type&&n.checked)&&i(e,n.name,n.value);g(e,u(t,n),l(o))}}),300),d=r((function(e){const t=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(t instanceof HTMLFormElement))return;const n=document.querySelector(".js-test-pattern-matches");if(n)if(0===e.length)n.textContent="";else{if(!window.codeEditor)return;window.codeEditor.save(),g(t,(()=>!0),l(n))}}),500),l=e=>t=>{if(0===t.length)e.textContent=" - No matches";else if(1===t.length)e.textContent=" - 1 match";else{const n=[];for(const e of t)n.push(JSON.stringify(e));const o=[...new Set(n)];e.textContent=` - ${o.length} matches`}},u=(e,t)=>n=>{if(function(e){var t,n,o;document.querySelector(".js-error-banner").hidden=!0;for(const r of e.getElementsByTagName("input"))if(null===(t=r.parentElement)||void 0===t?void 0:t.classList.contains("errored")){null===(n=r.parentElement)||void 0===n||n.classList.remove("form-group","errored");const e=r.getAttribute("aria-describedby");null===(o=document.querySelector("#"+e))||void 0===o||o.remove()}}(e),null==n?void 0:n.message){if(t.setAttribute("disabled","true"),"START_DELIMITER"===(null==n?void 0:n.error_type)||"END_DELIMITER"===(null==n?void 0:n.error_type)||"MUST_MATCH"===(null==n?void 0:n.error_type)||"MUST_NOT_MATCH"===(null==n?void 0:n.error_type)){const e=document.querySelector(".js-more-options.js-details-container");e&&(e.classList.add("open"),e.classList.add("Details--on"))}return function(e,t){var n,o;if("MUST_MATCH"===t.error_type||"MUST_NOT_MATCH"===t.error_type){let o=0;const r=e.getElementsByClassName("js-additional-secret-format");for(const e of r){if(o>(t.error_index||0))return;const r=[...e.getElementsByTagName("input")].filter((e=>e.checked)),s=r&&r[0].value.toUpperCase(),c=s===t.error_type&&o===t.error_index,i=[...e.getElementsByTagName("input")].filter((e=>"text"===e.type));if(!i||0===i.length)return;const a=i[0];if(""!==a.value){if(c){const e=a.id;null===(n=null==a?void 0:a.parentElement)||void 0===n||n.classList.add("form-group","errored");const o=document.createElement("p"),r=e+"_error_message";return o.classList.add("note","error","mt-5"),o.id=r,o.textContent=t.message,null==a||a.setAttribute("aria-describedby",r),void(null==a||a.insertAdjacentElement("afterend",o))}s===t.error_type&&o++}}}else{const e=p[t.error_type],n=document.querySelector("#"+e);null===(o=null==n?void 0:n.parentElement)||void 0===o||o.classList.add("form-group","errored");const r=document.createElement("p"),s=e+"_error_message";r.classList.add("note","error"),r.id=s,r.textContent=t.message,null==n||n.setAttribute("aria-describedby",s),null==n||n.insertAdjacentElement("afterend",r)}}(e,n),!1}return t.removeAttribute("disabled"),!0};function m(){const e=document.querySelector(".js-post-processing-expression-max-count");if(!e)return 5;const t=e.textContent;return t?parseInt(t):5}function f(){if(!window.codeEditor)return;const e=window.codeEditor.posFromIndex(0),t=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(const n of window.codeEditor.findMarks(e,t))n.clear()}const p={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name"};async function g(e,t,n){let o;try{const t=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{Accept:"application/json"}});t.ok&&(o=await t.json())}catch(r){}if(o&&t(o.error))if(o.has_matches){const e=JSON.parse(o.matches);f(),n(e);for(const t of e){const e=window.codeEditor.posFromIndex(t.start),n=window.codeEditor.posFromIndex(t.end);window.codeEditor.markText(e,n,{className:"bg-yellow-2"})}}else n([]),f()}}}}));
//# sourceMappingURL=scanning-970d6bca.js.map
