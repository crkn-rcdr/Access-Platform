# manifest documents

Database fields are similar to what was previoiusly in 'internalmeta', including data that was in hammer.json array index 0


# fields to be stored within couch documents

* dmd - hash of fields extracted from stored descriptive metadata, previously components stored as array index 0 of the hammer.json attachment. These are extracted from a temporarily generated "CMR" XML using [hammer2co.xsl](https://github.com/crkn-rcdr/CIHM-METS-parse/blob/master/lib/CIHM/METS/resource/xsl/hammer2co.xsl).  Common fields include: 
  * identifier - array if identifiers
  * label - label from descriptive metadata
  * lang - array of languages
  * no - array of notes
  * no_source - array of notes indicating source
  * pubmin - minimum date in date range
  * pubmax - maximum date in date range
  * seq - sequence stored within issueinfo
  * pkey - ID of the series within issueinfo
* canonicalDownload - reference to a download (usually PDF)
* canonicalDownloadMime - MIME-type of download
* canonicalDownloadSize - size (bytes) of download
* collectionDate - date when the list of collections was modified (used by Press)
* collections - array of collections
* created - date document was created
* hammer - hash of fields used by Hammer to know when to run, and to report on success/failure
  * message - message from Hammer (die/warn)
  * dmddate - date of processed descriptive metadata
  * status - boolean for success/failure of Hammer (Did it "die")
  * date when hammer ran
* label - label from METS, most often extracted from descriptive metadata when METS record created
* approved - date when manifest (and its canvases) were made public (unset means staff only)?
* parent? - reference to parent for issues. Should point to noid of collection, determined by Smelter?
* press - hash of fields used by Press to know when to run, and report on success/failure
  * status - boolean for success/failure
  * messsage - die/warn messages
  * date - date when Press run, used in comparing other dates to know when to next run
* slug - string representing slug
* updated - date of last update
* updatereq - date when a press update was requested (used as part of press handling of re-processing parent records, so this might be moved to 'collection' database.

# Fields that should be deprecated and/or stored/generated elsewhere

* dmd.depositor - currently based on the preservation ID (part before the first '.').  We should store a reference back to the preservation ID and generate this as current cosearch makes use of this.
* dmd.key - becomes slug
* dmd.pkey - refers to parent for an issue of a series, which we will need to think about.
* dmd.type - always "document"
* METS - hash of references to METS records, now in 'dipstaging' database
* METSDate - in 'dipstaging'
* METSManifestDate - in 'dipstaging'
* repos -- in 'dipstaging', never used within cosearch/copresentation
* reposDate - in 'dipstaging'
* reposManifestDate - in 'dipstaging'
* attachInfo - no attachments stored
* hammerfields - previously a list of fields from hammer within hammer.json attachment.  Fields now listed under dmd hash.
* pageinfo - relevant diagnostic information within 'canvas' database
* pubmin - duplication of dmd.pubmin
* seq - duplication of dmd.seq
* type - was always 'aip'
* sub-type - was one of "series" or "document", and series records now moving to 'collection' database


If we use any of these fields within cosearch(Solr) or copresentation then they can be generated by Press.
